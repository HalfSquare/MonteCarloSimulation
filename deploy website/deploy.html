<!doctype html>
<meta charset="UTF-8">
<title>Deploy</title>
<head>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
<header id="pageHeader">
    <div style="width: 100%; display: table;">
        <div style="display: table-row">
            <div style="width: 100%; text-align: left; display: table-cell;">
                <label id="status"></label>
            </div>
            <div style="display: table-cell;">
                <a href="http://www.google.com">Recommended</a>
                <br><br>
                <a href="http://www.google.com">Latest</a>
            </div>
        </div>
    </div>
</header>

<article id="mainArticle">
    <table id="releaseTable">
    </table>
</article>

<nav id="mainNav">
    <img src="img.jpg" alt="Image of big rocket">
</nav>

<footer id="pageFooter">
    Developed by Group 15
</footer>

<script>
    function parseAndDisplayTable(releases) {
        const data = JSON.parse(releases);

        table = document.getElementById("releaseTable");
        table.innerHTML = "";
        let row = table.insertRow(table.rows.length);
        Object.keys(data[0]).forEach((property) => {
            let cell = row.insertCell();
            cell.innerHTML = "<b>" + property + "</b>";
        });
        data.forEach((version) => {
            let row = table.insertRow(table.rows.length);
            Object.keys(version).forEach((property) => {
                let cell = row.insertCell();
                if (Array.isArray(version[property])) {
                  let smallTable = "";
                  version[property].forEach((note) => {
                      smallTable += "- " + note;
                      smallTable += "<br>"
                  });
                  cell.innerHTML = smallTable;
                }
                else if (property === "Link") {
                    cell.innerHTML = "<a href='" + version[property] + "'><i>Download</i></a>"
                }
                else {
                    cell.innerHTML = version[property];
                }
            });
        });
    }

    function readTextFile(fileName)
    {
        //https://stackoverflow.com/questions/14446447/how-to-read-a-local-text-file
        let file = new XMLHttpRequest();
        file.open("GET", fileName, false);
        file.onreadystatechange = () =>
        {
            if(file.readyState === 4)
            {
                if(file.status === 200 || file.status === 0)
                {
                    parseAndDisplayTable(file.response);
                }
            }
        }
        file.send(null);
    }

    window.onload = function () {
        readTextFile("tags.json");
    }
</script>
</body>